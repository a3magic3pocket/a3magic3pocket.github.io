<!DOCTYPE html><html lang="ko-KR" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="generator" content="Jekyll v4.2.0" /><meta property="og:title" content="블루 - 그린 배포 실험" /><meta property="og:locale" content="ko_KR" /><meta name="description" content="블루 - 그린 배포란? 두 개의 동일한 환경(블루와 그린)을 유지하며, 새 버전을 배포한 후 트래픽을 전환하여 새로운 버전을 운영에 적용" /><meta property="og:description" content="블루 - 그린 배포란? 두 개의 동일한 환경(블루와 그린)을 유지하며, 새 버전을 배포한 후 트래픽을 전환하여 새로운 버전을 운영에 적용" /><link rel="canonical" href="https://a3magic3pocket.github.io/posts/experimenting-with-blue-green-deployments/" /><meta property="og:url" content="https://a3magic3pocket.github.io/posts/experimenting-with-blue-green-deployments/" /><meta property="og:site_name" content="의사줌치" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2025-04-06T08:47:25+09:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="블루 - 그린 배포 실험" /><meta name="twitter:site" content="@twitter_username" /><meta name="google-site-verification" content="google_meta_tag_verification" /> <script type="application/ld+json"> {"description":"블루 - 그린 배포란? 두 개의 동일한 환경(블루와 그린)을 유지하며, 새 버전을 배포한 후 트래픽을 전환하여 새로운 버전을 운영에 적용","url":"https://a3magic3pocket.github.io/posts/experimenting-with-blue-green-deployments/","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https://a3magic3pocket.github.io/posts/experimenting-with-blue-green-deployments/"},"headline":"블루 - 그린 배포 실험","dateModified":"2025-05-08T21:47:25+09:00","datePublished":"2025-04-06T08:47:25+09:00","@context":"https://schema.org"}</script><title>블루 - 그린 배포 실험 | 의사줌치</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="의사줌치"><meta name="application-name" content="의사줌치"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="preconnect" href="https://cdn.jsdelivr.net"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script defer src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.15.0,npm/bootstrap@4/dist/js/bootstrap.min.js"></script> <script async src="https://cdn.jsdelivr.net/combine/npm/lozad/dist/lozad.min.js,npm/magnific-popup@1/dist/jquery.magnific-popup.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id=G-5NQ41XXW83"></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'G-5NQ41XXW83'); }); </script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src="/assets/img/sample/avatar-crop.png" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">의사줌치</a></div><div class="site-subtitle font-italic">부정확한 정보를 <br /> 담고 있을 수 있습니다.</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tags ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center"> <a href="https://github.com/a3magic3pocket" aria-label="github" class="order-3" target="_blank" rel="noopener"> <i class="fab fa-github-alt"></i> </a> <a href="https://twitter.com/twitter_username" aria-label="twitter" class="order-4" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['a3magic3pocket','gmail.com'].join('@')" aria-label="email" class="order-5" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" class="order-6" > <i class="fas fa-rss"></i> </a> <span class="icon-border order-2"></span> <span id="mode-toggle-wrapper" class="order-1"> <i class="mode-toggle fas fa-adjust"></i> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } var self = this; /* always follow the system prefers */ this.sysDarkPrefers.addListener(function() { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.updateMermaid(); }); } /* constructor() */ setDark() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_KEY); sessionStorage.removeItem(ModeToggle.MODE_KEY); } get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode == ModeToggle.DARK_MODE; } get isLightMode() { return this.mode == ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer) ) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } updateMermaid() { if (typeof mermaid !== "undefined") { let expectedTheme = (this.modeStatus === ModeToggle.DARK_MODE? "dark" : "default"); let config = { theme: expectedTheme }; /* re-render the SVG › <https://github.com/mermaid-js/mermaid/issues/311#issuecomment-332557344> */ $(".mermaid").each(function() { let svgCode = $(this).prev().children().html(); $(this).removeAttr("data-processed"); $(this).html(svgCode); }); mermaid.initialize(config); mermaid.init(undefined, ".mermaid"); } } flipMode() { if (this.hasMode) { if (this.isSysDarkPrefer) { if (this.isLightMode) { this.clearMode(); } else { this.setLight(); } } else { if (this.isDarkMode) { this.clearMode(); } else { this.setDark(); } } } else { if (this.isSysDarkPrefer) { this.setLight(); } else { this.setDark(); } } this.updateMermaid(); } /* flipMode() */ } /* ModeToggle */ let toggle = new ModeToggle(); $(".mode-toggle").click(function() { toggle.flipMode(); }); </script> </span></div></div><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Posts </a> </span> <span>블루 - 그린 배포 실험</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="post-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>블루 - 그린 배포 실험</h1><div class="post-meta text-muted d-flex flex-column"><div> <span class="semi-bold"> 의사줌치 </span> <span class="timeago " data-toggle="tooltip" data-placement="bottom" title="Sun, Apr 6, 2025, 8:47 AM +0900" prep="on" > Apr 6 <i class="unloaded">2025-04-06T08:47:25+09:00</i> </span></div><div> <span> <span class="timeago lastmod" data-toggle="tooltip" data-placement="bottom" title="Thu, May 8, 2025, 9:47 PM +0900" prefix="Updated " > May 8 <i class="unloaded">2025-05-08T21:47:25+09:00</i> </span> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="2739 words">15 min</span></div></div><div class="post-content"><h2 id="블루---그린-배포란">블루 - 그린 배포란?</h2><ul><li>두 개의 동일한 환경(블루와 그린)을 유지하며, <br /> 새 버전을 배포한 후 트래픽을 전환하여 새로운 버전을 운영에 적용</ul><h2 id="왜-하는가">왜 하는가?</h2><ul><li>새로운 애플리케이션 버전을 배포하면서 서비스 중단 없이<br /> 안전하게 전환하기 위해서</ul><h2 id="작동-방식">작동 방식</h2><ol><li>블루 환경에서 운영 중<ul><li>기존 애플리케이션(블루)이 사용자의 모든 트래픽을 처리하고 있음</ul><li>그린 환경에서 새 버전 배포<ul><li>새로운 애플리케이션 버전을 그린 환경에 배포한 뒤 테스트 수행</ul><li>트래픽 전환<ul><li>모든 트래픽을 블루 환경에서 그린 환경으로 전환<li>이 작업은 로드밸런서를 재설정하거나 DNS를 업데이트 하는 방식으로 수행</ul><li>블루 환경 유지(롤백 대비)<ul><li>그린 환경으로의 전환 후에도 블루 환경은 일정 시간 동안 유지하며<br /> 문제가 발생하면 즉시 롤백할 수 있도록 준비</ul></ol><h2 id="장점">장점</h2><ul><li>서비스 중단 없이 배포<ul><li>기존 환경은 유지되므로, 배포 중에도 사용자는 끊김 없는 서비스 이용 가능</ul><li>빠른 롤백 가능<ul><li>문제가 발생하면 그린 환경을 비활성하고 다시 블루로 트래픽 전환 가능</ul><li>테스트 환경 제공<ul><li>그린 환경에서 운영 환경과 동일한 조건으로 충분히 테스트 진행 가능</ul><li>배포 리스크 최소화<ul><li>새로운 버전 문제로 인해 운영 환경이 중단될 가능성을 크게 줄임</ul></ul><h2 id="단점">단점</h2><ul><li>추가 리소스 비용<ul><li>블루와 그린 두 개 환경을 동시에 유지해야 하므로 비용 증가</ul><li>데이터 동기화<ul><li>배포 시 데이터베이스와 같은 상태 정보를 <br /> 공유하거나 동기화하는 작업이 필요</ul></ul><h2 id="온프레미스-환경-블루---그린-배포를-한다면">온프레미스 환경 블루 - 그린 배포를 한다면?</h2><ul><li>가정<ul><li>물리 서버 3대가 있다.<li>서버1<ul><li>nginx 로드밸런서</ul><li>서버2, 서버3<ul><li>스프링 서버<li>docker compose 로 블루, 그린 환경을 각각 구성한다.<li>현재 배포된 도커 이미지는 my-server:0.0.1 이다.</ul><li>서버1에서 테스트 용 PC 접근 경로 설정<ul><li>테스트용 PC IP만 블루 또는 그린에 <br /> 선택적으로 접근할 수 있도록 nginx 설정</ul></ul><li>(1) 블루 환경에서 운영 중<li>(2) 그린 환경에서 새 버전 배포<ul><li>서버2, 서버3에서 새 버전 my-server:0.0.2를 확보한다.<li>새 버전 my-server:0.0.2는 <br /> docker-registry 서버에 pull 하는 방식으로 가져올 수도 있고<br /> 직접 빌드하여 만드는 방법을 사용할 수도 있다.<li>블루 환경 컨테이너는 그대로 둔 채<br /> 그린 환경 컨테이너를 my-server:0.0.2로 다시 올린다.<li>테스트용 PC에서 테스트를 진행한다.</ul><li>(3) 트래픽 전환<ul><li>nginx 로드밸런서에서 트래픽이 그린을 바라보도록<br /> 설정을 변경하고 리로드 한다.</ul><li>(4) 블루 환경 유지(롤백 대비)</ul><h2 id="로컬에서-온프레미스-환경-블루---그린-배포-실험">로컬에서 온프레미스 환경 블루 - 그린 배포 실험</h2><ul><li>가정<ul><li>물리 서버 대신 도커 컨테이너를 띄워서 진행한다.<li>컨테이너 구성<ul><li>nginx 로드밸런서 컨테이너<li>서버1 블루 컨테이너<li>서버1 그린 컨테이너<li>서버2 블루 컨테이너<li>서버2 그린 컨테이너</ul></ul><li>github repository<ul><li><a href="https://github.com/a3magic3pocket/blue-green-deployment-sandbox" target="_blank">blue-green-deployment-sandbox</a><li>앞으로의 모든 설명은 blue-green_manifest 디렉토리 하위를 기준으로 한다.</ul><li>준비<ul><li>서버<ul><li>설명<ul><li>스프링 서버<li>/ 로 접근 시 application.yml에 설정한 deployment 문자열을 출력한다.<li>/ 로 접근 시 블루면 blue가 표시되고 그린이면 green이 표시된다.</ul><li>빌드 파일 위치<ul><li>spring-0.0.1-SNAPSHOT.jar</ul><li>server-blue:0.0.1 이미지 생성<div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>docker build <span class="nt">-t</span> server-blue:0.0.1 <span class="nt">-f</span> ./Dockerfile-server <span class="nb">.</span>  
</pre></table></code></div></div><li>server-green:0.0.1 이미지 생성<div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>docker build <span class="nt">-t</span> server-green:0.0.1 <span class="nt">-f</span> ./Dockerfile-server <span class="nb">.</span>  
</pre></table></code></div></div></ul><li>nginx 로드밸런서 설정<ul><li>설명<ul><li>blue 버전에 트래픽 분배하는 설정파일과<br /> green 버전에 트래픽 분배하는 설정파일을 준비한다.<li>트래픽 분배 대상을 변경하고 싶다면<br /> nginx 설정을 변경한 후 nginx를 재시작한다.<li>blue 버전에 트래픽 분배하는 설정 위치<ul><li>blue-green_manifest/loadbalancer-nginx-blue.conf</ul><li>green 버전에 트래픽 분배하는 설정 위치<ul><li>blue-green_manifest/loadbalancer-nginx-green.conf</ul></ul><li>blue 버전에 트래픽 분배하는 설정<div class="language-text highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
</pre><td class="rouge-code"><pre># loadbalancer-nginx-blue.conf  
upstream blue-upstream {  
    server server1-blue:8080;  
    server server2-blue:8080;  
}  
                    
                    
upstream green-upstream {  
    server server1-green:8080;  
    server server2-green:8080;  
}  
                    
                    
server {  
    listen 80;  
                    
                    
    location / {  
        # 기본적으로 Blue 환경으로 라우팅  
        proxy_pass http://blue-upstream;  
    }  
                    
                    
    location /blue {  
        # 특정 IP만 Blue에 접근 가능  
        # allow test.pc.ip;  # 허용할 IP  
        # deny all;              # 다른 모든 IP는 거부  
                    
                    
        rewrite ^/blue/?(.*)?$ /$1 break;  
        proxy_pass http://blue-upstream/;  # Blue 환경으로 라우팅  
    }  
                    
                    
    location /green {  
        # 특정 IP만 Green에 접근 가능  
        # allow test.pc.ip;  # 허용할 IP  
        # deny all;              # 다른 모든 IP는 거부  
                    
                    
        rewrite ^/green/?(.*)?$ /$1 break;  
        proxy_pass http://green-upstream/;  # Green 환경으로 라우팅  
    }  
}  
</pre></table></code></div></div><li>green 버전에 트래픽 분배하는 설정<div class="language-text highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
</pre><td class="rouge-code"><pre># loadbalancer-nginx-green.conf  
upstream blue-upstream {  
    server server1-blue:8080;  
    server server2-blue:8080;  
}  
                    
                    
upstream green-upstream {  
    server server1-green:8080;  
    server server2-green:8080;  
}  
                    
                    
server {  
    listen 80;  
                    
                    
    location / {  
        # 기본적으로 Green 환경으로 라우팅  
        proxy_pass http://green-upstream;  
    }  
                    
                    
    location /blue {  
        # 특정 IP만 Blue에 접근 가능  
        # allow test.pc.ip;  # 허용할 IP  
        # deny all;              # 다른 모든 IP는 거부  
                    
                    
        rewrite ^/blue/?(.*)?$ /$1 break;  
        proxy_pass http://blue-upstream/;  # Blue 환경으로 라우팅  
    }  
                    
                    
    location /green {  
        # 특정 IP만 Green에 접근 가능  
        # allow test.pc.ip;  # 허용할 IP  
        # deny all;              # 다른 모든 IP는 거부  
                    
                    
        rewrite ^/green/?(.*)?$ /$1 break;  
        proxy_pass http://green-upstream/;  # Green 환경으로 라우팅  
    }  
}  
</pre></table></code></div></div></ul><li>docker-compose.yml<ul><li>설명<ul><li>nginx와 server 의 컨테이너를 제어하는 docker-compose.yml이다.</ul><li>docker-compose.yml<div class="language-yml highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
</pre><td class="rouge-code"><pre><span class="na">version</span><span class="pi">:</span> <span class="s1">'</span><span class="s">3.8'</span>  
                    
                    
<span class="na">services</span><span class="pi">:</span>  
  <span class="na">loadbalancer</span><span class="pi">:</span>  
    <span class="na">image</span><span class="pi">:</span> <span class="s">nginx:1.25.3-alpine</span>  
    <span class="na">container_name</span><span class="pi">:</span> <span class="s">loadbalancer</span>    
    <span class="na">ports</span><span class="pi">:</span>  
      <span class="pi">-</span> <span class="s2">"</span><span class="s">80:80"</span>  
    <span class="na">volumes</span><span class="pi">:</span>  
      <span class="pi">-</span> <span class="s">./loadbalancer-nginx-blue.conf:/etc/nginx/sites-available/loadbalancer-nginx-blue.conf</span>  
      <span class="pi">-</span> <span class="s">./loadbalancer-nginx-green.conf:/etc/nginx/sites-available/loadbalancer-nginx-green.conf</span>  
    <span class="na">depends_on</span><span class="pi">:</span>  
      <span class="pi">-</span> <span class="s">server1-blue</span>  
      <span class="pi">-</span> <span class="s">server1-green</span>  
      <span class="pi">-</span> <span class="s">server2-blue</span>  
      <span class="pi">-</span> <span class="s">server2-green</span>  
    <span class="na">extra_hosts</span><span class="pi">:</span>  
      <span class="pi">-</span> <span class="s2">"</span><span class="s">host.docker.internal:host-gateway"</span>  
    <span class="na">networks</span><span class="pi">:</span>  
      <span class="pi">-</span> <span class="s">plain-deployment-net</span>  
                    
                    
  <span class="na">server1-blue</span><span class="pi">:</span>  
    <span class="na">image</span><span class="pi">:</span> <span class="s">server-blue:0.0.1</span>  
    <span class="na">container_name</span><span class="pi">:</span> <span class="s">server1-blue</span>  
    <span class="na">command</span><span class="pi">:</span>  
      <span class="pi">-</span> <span class="s2">"</span><span class="s">java"</span>  
      <span class="pi">-</span> <span class="s2">"</span><span class="s">-jar"</span>  
      <span class="pi">-</span> <span class="s2">"</span><span class="s">/spring.jar"</span>  
      <span class="pi">-</span> <span class="s2">"</span><span class="s">--deployment=blue"</span>  
    <span class="na">networks</span><span class="pi">:</span>  
      <span class="pi">-</span> <span class="s">plain-deployment-net</span>  
                    
                    
  <span class="na">server1-green</span><span class="pi">:</span>  
    <span class="na">image</span><span class="pi">:</span> <span class="s">server-green:0.0.1</span>  
    <span class="na">container_name</span><span class="pi">:</span> <span class="s">server1-green</span>  
    <span class="na">command</span><span class="pi">:</span>  
      <span class="pi">-</span> <span class="s2">"</span><span class="s">java"</span>  
      <span class="pi">-</span> <span class="s2">"</span><span class="s">-jar"</span>  
      <span class="pi">-</span> <span class="s2">"</span><span class="s">/spring.jar"</span>  
      <span class="pi">-</span> <span class="s2">"</span><span class="s">--deployment=green"</span>  
    <span class="na">networks</span><span class="pi">:</span>  
      <span class="pi">-</span> <span class="s">plain-deployment-net</span>  
                    
                    
  <span class="na">server2-blue</span><span class="pi">:</span>  
    <span class="na">image</span><span class="pi">:</span> <span class="s">server-blue:0.0.1</span>  
    <span class="na">container_name</span><span class="pi">:</span> <span class="s">server2-blue</span>  
    <span class="na">command</span><span class="pi">:</span>  
      <span class="pi">-</span> <span class="s2">"</span><span class="s">java"</span>  
      <span class="pi">-</span> <span class="s2">"</span><span class="s">-jar"</span>  
      <span class="pi">-</span> <span class="s2">"</span><span class="s">/spring.jar"</span>  
      <span class="pi">-</span> <span class="s2">"</span><span class="s">--deployment=blue"</span>  
    <span class="na">networks</span><span class="pi">:</span>  
      <span class="pi">-</span> <span class="s">plain-deployment-net</span>  
                    
                    
  <span class="na">server2-green</span><span class="pi">:</span>  
    <span class="na">image</span><span class="pi">:</span> <span class="s">server-green:0.0.1</span>  
    <span class="na">container_name</span><span class="pi">:</span> <span class="s">server2-green</span>  
    <span class="na">command</span><span class="pi">:</span>  
      <span class="pi">-</span> <span class="s2">"</span><span class="s">java"</span>  
      <span class="pi">-</span> <span class="s2">"</span><span class="s">-jar"</span>  
      <span class="pi">-</span> <span class="s2">"</span><span class="s">/spring.jar"</span>  
      <span class="pi">-</span> <span class="s2">"</span><span class="s">--deployment=green"</span>  
    <span class="na">networks</span><span class="pi">:</span>  
      <span class="pi">-</span> <span class="s">plain-deployment-net</span>  
                    
                    
<span class="na">networks</span><span class="pi">:</span>  
  <span class="na">plain-deployment-net</span><span class="pi">:</span>  
</pre></table></code></div></div><li>명령<div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre><span class="c"># 실행  </span>
docker compose <span class="nt">-f</span> ./docker-compose.yml up  
                    
<span class="c"># 종료  </span>
docker compose <span class="nt">-f</span> ./docker-compose.yml down  
</pre></table></code></div></div></ul></ul><li>로드밸런서 nginx에서 블루로 트래픽 분배<ul><li>명령<div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre>docker compose <span class="nt">-f</span> ./docker-compose.yml <span class="nb">exec </span>loadbalancer sh <span class="nt">-c</span> <span class="s2">"  
  mv /etc/nginx/conf.d/default.conf /etc/nginx/conf.d/default.conf.bak   
  rm -rf /etc/nginx/conf.d/*.conf  
  ln -s /etc/nginx/sites-available/loadbalancer-nginx-blue.conf /etc/nginx/conf.d/  
  nginx -t  
  nginx -s reload  
"</span>  
</pre></table></code></div></div><li>확인<ul><li>브라우저에서 http://localhost 으로 들어가 <br /> blue 문자열이 나오는지 확인</ul></ul><li>새로운 그린 이미지를 빌드하고 <br /> 로드밸런서 nginx에서 트래픽을 블루에서 그린으로 변경<ul><li>새로운 그린 이미지 빌드 (server-green:0.0.2)<div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>docker build <span class="nt">-t</span> server-green:0.0.2 <span class="nt">-f</span> ./Dockerfile-server <span class="nb">.</span>  
</pre></table></code></div></div><li>docker-compose.yml에서 그린 이미지를 <br /> 새로 빌드한 이미지(server-green:0.0.2)로 변경<div class="language-yml highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
</pre><td class="rouge-code"><pre><span class="na">version</span><span class="pi">:</span> <span class="s1">'</span><span class="s">3.8'</span>  
                
                
<span class="na">services</span><span class="pi">:</span>  
  <span class="na">loadbalancer</span><span class="pi">:</span>  
    <span class="na">image</span><span class="pi">:</span> <span class="s">nginx:1.25.3-alpine</span>  
    <span class="na">container_name</span><span class="pi">:</span> <span class="s">loadbalancer</span>    
    <span class="na">ports</span><span class="pi">:</span>  
      <span class="pi">-</span> <span class="s2">"</span><span class="s">80:80"</span>  
    <span class="na">volumes</span><span class="pi">:</span>  
      <span class="pi">-</span> <span class="s">./loadbalancer-nginx-blue.conf:/etc/nginx/sites-available/loadbalancer-nginx-blue.conf</span>  
      <span class="pi">-</span> <span class="s">./loadbalancer-nginx-green.conf:/etc/nginx/sites-available/loadbalancer-nginx-green.conf</span>  
    <span class="na">depends_on</span><span class="pi">:</span>  
      <span class="pi">-</span> <span class="s">server1-blue</span>  
      <span class="pi">-</span> <span class="s">server1-green</span>  
      <span class="pi">-</span> <span class="s">server2-blue</span>  
      <span class="pi">-</span> <span class="s">server2-green</span>  
    <span class="na">extra_hosts</span><span class="pi">:</span>  
      <span class="pi">-</span> <span class="s2">"</span><span class="s">host.docker.internal:host-gateway"</span>  
    <span class="na">networks</span><span class="pi">:</span>  
      <span class="pi">-</span> <span class="s">plain-deployment-net</span>  
                
                
  <span class="na">server1-blue</span><span class="pi">:</span>  
    <span class="na">image</span><span class="pi">:</span> <span class="s">server-blue:0.0.1</span>  
    <span class="na">container_name</span><span class="pi">:</span> <span class="s">server1-blue</span>  
    <span class="na">command</span><span class="pi">:</span>  
      <span class="pi">-</span> <span class="s2">"</span><span class="s">java"</span>  
      <span class="pi">-</span> <span class="s2">"</span><span class="s">-jar"</span>  
      <span class="pi">-</span> <span class="s2">"</span><span class="s">/spring.jar"</span>  
      <span class="pi">-</span> <span class="s2">"</span><span class="s">--deployment=blue"</span>  
    <span class="na">networks</span><span class="pi">:</span>  
      <span class="pi">-</span> <span class="s">plain-deployment-net</span>  
                
                
  <span class="na">server1-green</span><span class="pi">:</span>  
    <span class="c1"># | -- 수정 시작 -- |</span>
    <span class="na">image</span><span class="pi">:</span> <span class="s">server-green:0.0.2</span>  
    <span class="c1"># | -- 수정 끝 -- |</span>
    <span class="na">container_name</span><span class="pi">:</span> <span class="s">server1-green</span>  
    <span class="na">command</span><span class="pi">:</span>  
      <span class="pi">-</span> <span class="s2">"</span><span class="s">java"</span>  
      <span class="pi">-</span> <span class="s2">"</span><span class="s">-jar"</span>  
      <span class="pi">-</span> <span class="s2">"</span><span class="s">/spring.jar"</span>  
      <span class="pi">-</span> <span class="s2">"</span><span class="s">--deployment=green"</span>  
    <span class="na">networks</span><span class="pi">:</span>  
      <span class="pi">-</span> <span class="s">plain-deployment-net</span>  
                
                
  <span class="na">server2-blue</span><span class="pi">:</span>  
    <span class="na">image</span><span class="pi">:</span> <span class="s">server-blue:0.0.1</span>  
    <span class="na">container_name</span><span class="pi">:</span> <span class="s">server2-blue</span>  
    <span class="na">command</span><span class="pi">:</span>  
      <span class="pi">-</span> <span class="s2">"</span><span class="s">java"</span>  
      <span class="pi">-</span> <span class="s2">"</span><span class="s">-jar"</span>  
      <span class="pi">-</span> <span class="s2">"</span><span class="s">/spring.jar"</span>  
      <span class="pi">-</span> <span class="s2">"</span><span class="s">--deployment=blue"</span>  
    <span class="na">networks</span><span class="pi">:</span>  
      <span class="pi">-</span> <span class="s">plain-deployment-net</span>  
                
                
  <span class="na">server2-green</span><span class="pi">:</span>  
    <span class="c1"># | -- 수정 시작 -- |</span>
    <span class="na">image</span><span class="pi">:</span> <span class="s">server-green:0.0.2</span>  
    <span class="c1"># | -- 수정 끝 -- |</span>
    <span class="na">container_name</span><span class="pi">:</span> <span class="s">server2-green</span>  
    <span class="na">command</span><span class="pi">:</span>  
      <span class="pi">-</span> <span class="s2">"</span><span class="s">java"</span>  
      <span class="pi">-</span> <span class="s2">"</span><span class="s">-jar"</span>  
      <span class="pi">-</span> <span class="s2">"</span><span class="s">/spring.jar"</span>  
      <span class="pi">-</span> <span class="s2">"</span><span class="s">--deployment=green"</span>  
    <span class="na">networks</span><span class="pi">:</span>  
      <span class="pi">-</span> <span class="s">plain-deployment-net</span>  
                
                
<span class="na">networks</span><span class="pi">:</span>  
  <span class="na">plain-deployment-net</span><span class="pi">:</span>  
</pre></table></code></div></div><li>sever1-green에 변경 사항 적용<br /> (server1-green 컨테이너 이미지를 server-green:0.0.2 로 변경)<div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>docker-compose up <span class="nt">-d</span> <span class="nt">--no-deps</span> <span class="nt">--force-recreate</span> server1-green  
</pre></table></code></div></div><li>server2-green에 변경 사항 적용<br /> (server2-green 컨테이너 이미지를 server-green:0.0.2 로 변경)<div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>docker-compose up <span class="nt">-d</span> <span class="nt">--no-deps</span> <span class="nt">--force-recreate</span> server1-green  
</pre></table></code></div></div><li>테스트<ul><li>sever1-green, sever2-green 컨테이너에 적용된<br /> 이미지가 잘 교체되었는지 확인<div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre>docker ps | <span class="nb">grep </span>green  | <span class="nb">sed</span> <span class="s1">'s/  */ /g'</span> | <span class="nb">awk</span> <span class="s1">'{ print $2, $12 }'</span>  
                    
<span class="c">## 결과가 아래와 같이 나와야 함  </span>
<span class="c"># server-green:0.0.2 server2-green  </span>
<span class="c"># server-green:0.0.2 server1-green  </span>
</pre></table></code></div></div><li>브라우저에서 http://localhost/green 으로 들어가 <br /> green 문자열이 나오는지 확인</ul><li>로드밸런서 nginx에서 트래픽을 그린으로 분배하도록 변경<ul><li>명령<div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre>docker compose <span class="nt">-f</span> ./docker-compose.yml <span class="nb">exec </span>loadbalancer sh <span class="nt">-c</span> <span class="s2">"  
  mv /etc/nginx/conf.d/default.conf /etc/nginx/conf.d/default.conf.bak   
  rm -rf /etc/nginx/conf.d/*.conf  
  ln -s /etc/nginx/sites-available/loadbalancer-nginx-green.conf /etc/nginx/conf.d/  
  nginx -t  
  nginx -s reload  
"</span>  
</pre></table></code></div></div><li>확인<ul><li>브라우저에서 http://localhost 으로 들어가 <br /> green 문자열이 나오는지 확인</ul></ul></ul></ul><h2 id="주의할-점">주의할 점</h2><ul><li>블루-그린 데이터 동기화를 위해 <br /> 두 버전에 호환되게 스키마를 운영해야한다.<ul><li>기존 컬럼 삭제<ul><li>버전 배포 전까지 기존 컬럼을 DB에서 바로 삭제하지 않고, <br /> 애플리케이션에서만 제거<li>오랜 시간 운영 후, 해당 컬럼을 참조하는 코드가 <br /> 완전히 제거된 다음 버전이 배포되면 DB에서 컬럼 삭제</ul><li>컬럼 수정 (VARCHAR → JSON 예시)<ul><li>새로운 컬럼(contents_new) 추가 (기존 contents 컬럼 유지)<li>기존 데이터를 contents_new로 마이그레이션<li>새 버전 애플리케이션에서 contents_new 컬럼을 사용하도록 수정<li>충분한 운영 후 contents 컬럼이 더 이상 사용되지 않으면 삭제</ul></ul><li>블루-그린 배포에서 DB 사용 방식<ul><li>하나의 DB 사용<ul><li>트래픽 변경 시 애플리케이션만 전환하면 되므로 편리하다.<li>대규모 테이블 변경 시 라이브 서비스에 영향 가능성이 있다.</ul><li>별도의 DB 사용<ul><li>새 버전 배포 시 기존 서비스(DB)에 영향을 주지 않는다.<li>두 버전이 서로 다른 DB를 사용하므로 <br /> 데이터 동기화를 위한 CDC(Kafka Connect 등) 필요하다.<li>DB가 버전 별로 필요하고 CDC도 사용해야 하므로<br /> 리소스 소비가 상대적으로 많다.<li>동기화 문제로 인해 롤백이 더 복잡하다.</ul></ul></ul><h2 id="예시-repository">예시 repository</h2><ul><li><a href="https://github.com/a3magic3pocket/blue-green-deployment-sandbox" target="_blank">blue-green-deployment-sandbox</a></ul></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/deployment/'>Deployment</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/blue-green/" class="post-tag no-text-decoration" >blue-green</a> <a href="/tags/essay/" class="post-tag no-text-decoration" >essay</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=블루 - 그린 배포 실험 - 의사줌치&url=https://a3magic3pocket.github.io/posts/experimenting-with-blue-green-deployments/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=블루 - 그린 배포 실험 - 의사줌치&u=https://a3magic3pocket.github.io/posts/experimenting-with-blue-green-deployments/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=블루 - 그린 배포 실험 - 의사줌치&url=https://a3magic3pocket.github.io/posts/experimenting-with-blue-green-deployments/" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i class="fa-fw fas fa-link small" onclick="copyLink()" data-toggle="tooltip" data-placement="top" title="Copy link"></i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"><div id="access-lastmod" class="post"> <span>Recent Update</span><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/kafka-large-scale-event-processing-architecture-and-performance-comparison/">Kafka를 활용한 대용량 이벤트 처리 구조 설계와 성능 비교</a><li><a href="/posts/experimenting-with-blue-green-deployments/">블루 - 그린 배포 실험</a><li><a href="/posts/spring-kafka-latest-message-pub-sub-config/">Spring Kafka에서 최신 메시지만 소비하는 Pub/Sub 방식 설정</a><li><a href="/posts/solving-concurrency-problems-with-performance-in-mind/">동시성 문제 해결 방안 성능 실험</a><li><a href="/posts/exploring-authentication-options/">인증방식 고민</a></ul></div><div id="access-tags"> <span>Trending Tags</span><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/kafka/">kafka</a> <a class="post-tag" href="/tags/kotlin/">kotlin</a> <a class="post-tag" href="/tags/elasticsearch/">elasticsearch</a> <a class="post-tag" href="/tags/elk/">elk</a> <a class="post-tag" href="/tags/spring/">spring</a> <a class="post-tag" href="/tags/summary/">summary</a> <a class="post-tag" href="/tags/git/">git</a> <a class="post-tag" href="/tags/kafka-streams/">kafka-streams</a> <a class="post-tag" href="/tags/nest/">nest</a> <a class="post-tag" href="/tags/react/">react</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"> <span class="pl-3 pt-2 mb-2">Contents</span><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="post-extend-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/solving-concurrency-problems-with-performance-in-mind/"><div class="card-body"> <span class="timeago small" > Apr 6 <i class="unloaded">2025-04-06T08:48:05+09:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>동시성 문제 해결 방안 성능 실험</h3><div class="text-muted small"><p> 동시성 문제란? 여러 프로세스나 스레드가 동시에 실행되는 상황에서 자원(데이터 등)을 제대로 공유하거나 수정하지 못해 발생하는 문제 구체적인 상황 id, numLikes 필드로 이뤄진 POST 테이블이 있다. likePost 함수는 postId를 인자로 받고, post을 조회한 뒤 기존 numLikes를 읽고 그 값에 +1을 한 ...</p></div></div></a></div><div class="card"> <a href="/posts/exploring-authentication-options/"><div class="card-body"> <span class="timeago small" > Apr 6 <i class="unloaded">2025-04-06T08:49:12+09:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>인증방식 고민</h3><div class="text-muted small"><p> 세션 인증 방식과 JWT 인증 방식의 차이 세션 방식 서버에서 사용자 정보를 key-value 저장소에 저장 서버에서 key를 사용자 쿠키에 담아서 전송 사용자가 인증이 필요한 요청을 하면 요청과 함께 키가 담긴 쿠키가 서버로 전송됨 서버는 key를 가지고 key-value 저장소를 조회하여 인...</p></div></div></a></div><div class="card"> <a href="/posts/metrics-monitoring-with-prometheus-grafana-and-alertmanager/"><div class="card-body"> <span class="timeago small" > Apr 6 <i class="unloaded">2025-04-06T08:49:51+09:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>메트릭 모니터링(prometheus, grafana, alertmanager)</h3><div class="text-muted small"><p> 정의 시스템 상태와 성능을 지속적으로 관찰하고 분석하는 과정 이를 통해 문제를 조기에 발견하는 것을 목표로 한다. 메트릭(metric)이란 시스템, 애플리케이션 또는 프로세스의 성능이나 상태를 수치적으로 표현한 데이터 포인트 우리는 메트릭을 지속적으로 수집하여 문제 발생 시 경고(alert)을 보내거나 시각화하여 문제를 빠르게 판단...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/setting-https-for-oracle-cloud-load-balancer/" class="btn btn-outline-primary" prompt="Older"><p>오라클 클라우드 로드밸런서 HTTPS 설정하기</p></a> <a href="/posts/solving-concurrency-problems-with-performance-in-mind/" class="btn btn-outline-primary" prompt="Newer"><p>동시성 문제 해결 방안 성능 실험</p></a></div></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center"><div class="footer-left"><p class="mb-0"> © 2025 <a href="https://github.com/a3magic3pocket">의사줌치</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><h4 class="text-muted mb-4">Trending Tags</h4><a class="post-tag" href="/tags/kafka/">kafka</a> <a class="post-tag" href="/tags/kotlin/">kotlin</a> <a class="post-tag" href="/tags/elasticsearch/">elasticsearch</a> <a class="post-tag" href="/tags/elk/">elk</a> <a class="post-tag" href="/tags/spring/">spring</a> <a class="post-tag" href="/tags/summary/">summary</a> <a class="post-tag" href="/tags/git/">git</a> <a class="post-tag" href="/tags/kafka-streams/">kafka streams</a> <a class="post-tag" href="/tags/nest/">nest</a> <a class="post-tag" href="/tags/react/">react</a></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.7.3/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="https://a3magic3pocket.github.io{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script>
