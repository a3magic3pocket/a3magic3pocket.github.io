<!DOCTYPE html><html lang="ko-KR" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="generator" content="Jekyll v4.2.0" /><meta property="og:title" content="git push 시 자동으로 pull and push하는 shell script 작성" /><meta property="og:locale" content="ko_KR" /><meta name="description" content="개요 git push 전 git db를 최신화 시키고 이를 rebase 하여 local에서 conflict 처리를 하고자 한다. 이를 위해 해당 기능의 명령어를 shell script로 작성하여 해결하였다." /><meta property="og:description" content="개요 git push 전 git db를 최신화 시키고 이를 rebase 하여 local에서 conflict 처리를 하고자 한다. 이를 위해 해당 기능의 명령어를 shell script로 작성하여 해결하였다." /><link rel="canonical" href="https://a3magic3pocket.github.io/posts/pull-and-push-automation/" /><meta property="og:url" content="https://a3magic3pocket.github.io/posts/pull-and-push-automation/" /><meta property="og:site_name" content="의사줌치" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2021-07-23T18:37:00+09:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="git push 시 자동으로 pull and push하는 shell script 작성" /><meta name="twitter:site" content="@twitter_username" /><meta name="google-site-verification" content="google_meta_tag_verification" /> <script type="application/ld+json"> {"description":"개요 git push 전 git db를 최신화 시키고 이를 rebase 하여 local에서 conflict 처리를 하고자 한다. 이를 위해 해당 기능의 명령어를 shell script로 작성하여 해결하였다.","url":"https://a3magic3pocket.github.io/posts/pull-and-push-automation/","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https://a3magic3pocket.github.io/posts/pull-and-push-automation/"},"headline":"git push 시 자동으로 pull and push하는 shell script 작성","dateModified":"2021-08-23T09:23:48+09:00","datePublished":"2021-07-23T18:37:00+09:00","@context":"https://schema.org"}</script><title>git push 시 자동으로 pull and push하는 shell script 작성 | 의사줌치</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="의사줌치"><meta name="application-name" content="의사줌치"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="preconnect" href="https://cdn.jsdelivr.net"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script defer src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.15.0,npm/bootstrap@4/dist/js/bootstrap.min.js"></script> <script async src="https://cdn.jsdelivr.net/combine/npm/lozad/dist/lozad.min.js,npm/magnific-popup@1/dist/jquery.magnific-popup.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id=G-5NQ41XXW83"></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'G-5NQ41XXW83'); }); </script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src="/assets/img/sample/avatar-crop.png" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">의사줌치</a></div><div class="site-subtitle font-italic">부정확한 정보를 <br /> 담고 있을 수 있습니다.</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tags ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center"> <a href="https://github.com/a3magic3pocket" aria-label="github" class="order-3" target="_blank" rel="noopener"> <i class="fab fa-github-alt"></i> </a> <a href="https://twitter.com/twitter_username" aria-label="twitter" class="order-4" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['a3magic3pocket','gmail.com'].join('@')" aria-label="email" class="order-5" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" class="order-6" > <i class="fas fa-rss"></i> </a> <span class="icon-border order-2"></span> <span id="mode-toggle-wrapper" class="order-1"> <i class="mode-toggle fas fa-adjust"></i> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } var self = this; /* always follow the system prefers */ this.sysDarkPrefers.addListener(function() { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.updateMermaid(); }); } /* constructor() */ setDark() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_KEY); sessionStorage.removeItem(ModeToggle.MODE_KEY); } get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode == ModeToggle.DARK_MODE; } get isLightMode() { return this.mode == ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer) ) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } updateMermaid() { if (typeof mermaid !== "undefined") { let expectedTheme = (this.modeStatus === ModeToggle.DARK_MODE? "dark" : "default"); let config = { theme: expectedTheme }; /* re-render the SVG › <https://github.com/mermaid-js/mermaid/issues/311#issuecomment-332557344> */ $(".mermaid").each(function() { let svgCode = $(this).prev().children().html(); $(this).removeAttr("data-processed"); $(this).html(svgCode); }); mermaid.initialize(config); mermaid.init(undefined, ".mermaid"); } } flipMode() { if (this.hasMode) { if (this.isSysDarkPrefer) { if (this.isLightMode) { this.clearMode(); } else { this.setLight(); } } else { if (this.isDarkMode) { this.clearMode(); } else { this.setDark(); } } } else { if (this.isSysDarkPrefer) { this.setLight(); } else { this.setDark(); } } this.updateMermaid(); } /* flipMode() */ } /* ModeToggle */ let toggle = new ModeToggle(); $(".mode-toggle").click(function() { toggle.flipMode(); }); </script> </span></div></div><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Posts </a> </span> <span>git push 시 자동으로 pull and push하는 shell script 작성</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="post-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>git push 시 자동으로 pull and push하는 shell script 작성</h1><div class="post-meta text-muted d-flex flex-column"><div> <span class="semi-bold"> 의사줌치 </span> <span class="timeago " data-toggle="tooltip" data-placement="bottom" title="Fri, Jul 23, 2021, 6:37 PM +0900" prep="on" > Jul 23, 2021 <i class="unloaded">2021-07-23T18:37:00+09:00</i> </span></div><div> <span> <span class="timeago lastmod" data-toggle="tooltip" data-placement="bottom" title="Mon, Aug 23, 2021, 9:23 AM +0900" prefix="Updated " > Aug 23, 2021 <i class="unloaded">2021-08-23T09:23:48+09:00</i> </span> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="2017 words">11 min</span></div></div><div class="post-content"><h2 id="개요">개요</h2><ul><li>git push 전 git db를 최신화 시키고 이를 rebase 하여 local에서 conflict 처리를 하고자 한다.<li>이를 위해 해당 기능의 명령어를 shell script로 작성하여 해결하였다.</ul><h2 id="발단형상관리-방법의-변화">발단(형상관리 방법의 변화)</h2><ul><li>메인페이지의 빈번한 수정이 요청됨에 따라 배포 주기가 엄청 짧아졌다.<li>이에 대응하기 위해 형상관리 방법을 아래와 같이 간결하게 변경하였다.<ul><li>기존 방식<ol><li>(팀장) 공용 remote github repo 생성<li>(팀장) 실서버 배포용으로 &lt;main&gt; 브런치, 개발용 브런치로 &lt;dev&gt; 브런치 생성<li>(개발자) remote github repo를 fork 뜸(앞으로 forked repo라 명명)<li>(개발자) local에 forked repo를 클론하고 &lt;dev&gt; 브런치 생성<li>(개발자) local &lt;dev&gt;에서 수정 후 commit하고 forked repo &lt;dev&gt;로 push<li>(개발자) forked repo &lt;dev&gt;에서 변경사항을 remote github repo &lt;dev&gt;로 pull request<li>(팀장) pull request 확인 후 merge 할지 결정</ol><li>변경된 방식<ol><li>(팀장) 공용 remote github repo 생성<li>(팀장) 실서버 배포용으로 main 브런치, 개발용 브런치로 dev 브런치 생성<li>(개발자) local에 remote github repo를 클론하고 &lt;dev&gt; 브런치 생성<li>(개발자) local &lt;dev&gt;에서 수정 후 commit하고 remote github repo &lt;dev&gt;로 push</ol></ul><li>발생 가능한 문제<ol><li>여러 개발자가 하나의 repo에 직접 push하기 때문에 conflict이 날 가능성이 높다.<li>개발물 적용 전 (팀장)의 확인 과정이 없어 불완전한 코드가 merge 될 가능성이 존재한다.<br /> 이 부분은 실서버 반영전 테스트 서버에 우선 배포해 충분 테스트를 하여 어느 정도 해소한다.</ol><li>발생 가능한 문제 1.의 해결<ol><li>push 후 conflict이 나면 github에서 어떤 것을 반영할지 정하고 수정해서 merge 해야한다.<li>이는 local에서 conflict을 처리하는 것보다 매우 불편함으로 되도록<br /> git push 전 git db를 최신화 시키고 이를 rebase 하여 local에서<br /> conflict 처리를 하고자 한다.<li>이를 위한 shell script를 작성하여 더 편하게 push를 하도록하였다.</ol></ul><h2 id="local에서-conflict-처리">local에서 conflict 처리</h2><ol><li>remote github repo의 최신 git db를 local git에 반영하고 현재 commit에 rebase<ul><li><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre>  <span class="c">## git pull --rebase [remote repo nickname in local] [local branch name]</span>
  <span class="c"># remote repo nickname in local을 여기선 'upstream' 이라고 가정</span>
  <span class="c"># 우리는 현재 dev 브런치만 사용한다고 가정</span>
  git pull <span class="nt">--rebase</span> upstream dev
</pre></table></code></div></div><li>이 과정에서 conflict이 발생할 수 있다.<li>conflict이 발생하면 적절히 판단하여 조치 후 merge commit을 하면 된다.</ul><li>local의 지금까지 변경사항을 remote github repo에 push<ul><li><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre>  <span class="c">## git push [remote repo nickname in local] [local branch name]</span>
  <span class="c"># remote repo nickname in local을 여기선 'upstream' 이라고 가정</span>
  <span class="c"># 우리는 현재 dev 브런치만 사용한다고 가정</span>
  git push upstream dev
</pre></table></code></div></div></ul><li>local의 지금까지 변경사항을 forked repo에 push<ul><li><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre>  <span class="c">## git push [forked repo nickname in local] [local branch name]</span>
  <span class="c"># forked repo nickname in local을 여기선 'origin' 이라고 가정</span>
  <span class="c"># 우리는 현재 dev 브런치만 사용한다고 가정</span>
  git push origin dev
</pre></table></code></div></div><li>현재는 forked repo를 쓰지 않지만 그래도 최신화 해줌</ul><li>1~3과정을 순차적으로 실행하되 하나라도 실패하면<br /> 그 다음 과정을 진행하지 않고 멈춰야한다.</ol><h2 id="shell-script">Shell script</h2><ul><li><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
</pre><td class="rouge-code"><pre>  <span class="c">#!/usr/bin/env bash</span>
  <span class="nv">TRUE</span><span class="o">=</span>1
  <span class="nv">FALSE</span><span class="o">=</span>0

  <span class="k">function </span>is_succeeded_git_command<span class="o">()</span> <span class="o">{</span>
      <span class="nb">local </span><span class="nv">message</span><span class="o">=</span><span class="nv">$1</span>

      <span class="k">if</span> <span class="o">[[</span> <span class="k">${</span><span class="nv">message</span><span class="k">}</span> <span class="o">==</span> <span class="k">*</span>error<span class="k">*</span> <span class="o">]]</span><span class="p">;</span> <span class="k">then
          return</span> <span class="k">${</span><span class="nv">FALSE</span><span class="k">}</span>
      <span class="k">fi

      return</span> <span class="k">${</span><span class="nv">TRUE</span><span class="k">}</span>
  <span class="o">}</span>

  <span class="k">function </span>sleep_with_msg<span class="o">()</span> <span class="o">{</span>
      <span class="nb">local </span><span class="nv">sleep_sec</span><span class="o">=</span><span class="nv">$1</span>
      <span class="nb">echo</span> <span class="s2">"+-- sleep </span><span class="k">${</span><span class="nv">sleep_sec</span><span class="k">}</span><span class="s2"> sec"</span>
      <span class="nb">sleep</span> <span class="k">${</span><span class="nv">sleep_sec</span><span class="k">}</span>
  <span class="o">}</span>

  <span class="k">function </span>pull_and_push<span class="o">()</span> <span class="o">{</span>
      <span class="nb">echo</span> <span class="s2">"+-- pull --rebase from upstream dev"</span>
      <span class="nv">result</span><span class="o">=</span>1

      <span class="c"># Catch stderr of this command</span>
      <span class="nv">result</span><span class="o">=</span><span class="sb">`</span>git pull <span class="nt">--rebase</span> upstream dev 2&gt;&amp;1<span class="sb">`</span>
      sleep_with_msg 0.5

      is_succeeded_git_command <span class="s2">"</span><span class="k">${</span><span class="nv">result</span><span class="k">}</span><span class="s2">"</span>
      <span class="nv">is_succeeded</span><span class="o">=</span><span class="nv">$?</span>
      <span class="k">if</span> <span class="o">[[</span> is_succeeded <span class="nt">-eq</span> <span class="k">${</span><span class="nv">FALSE</span><span class="k">}</span> <span class="o">]]</span><span class="p">;</span> <span class="k">then
          </span><span class="nb">echo</span> <span class="s2">"</span><span class="k">${</span><span class="nv">result</span><span class="k">}</span><span class="s2">"</span>
          <span class="nb">echo</span> <span class="s2">"+-- failed"</span>
          <span class="k">return </span>9001 
      <span class="k">fi
      </span><span class="nb">echo</span> <span class="s2">"echo result :: </span><span class="k">${</span><span class="nv">result</span><span class="k">}</span><span class="s2">"</span>

      <span class="c"># Catch stderr of this command</span>
      <span class="nb">echo</span> <span class="s2">"+-- push from local dev to upstream dev"</span>
      <span class="nv">result</span><span class="o">=</span><span class="sb">`</span>git push upstream dev 2&gt;&amp;1<span class="sb">`</span>
      sleep_with_msg 0.5

      is_succeeded_git_command <span class="s2">"</span><span class="k">${</span><span class="nv">result</span><span class="k">}</span><span class="s2">"</span>
      <span class="nv">is_succeeded</span><span class="o">=</span><span class="nv">$?</span>
      <span class="k">if</span> <span class="o">[[</span> is_succeeded <span class="nt">-eq</span> <span class="k">${</span><span class="nv">FALSE</span><span class="k">}</span> <span class="o">]]</span><span class="p">;</span> <span class="k">then
          </span><span class="nb">echo</span> <span class="s2">"</span><span class="k">${</span><span class="nv">result</span><span class="k">}</span><span class="s2">"</span>
          <span class="nb">echo</span> <span class="s2">"+-- failed"</span>
          <span class="k">return </span>9001
      <span class="k">fi
      </span><span class="nb">echo</span> <span class="s2">"echo result :: </span><span class="k">${</span><span class="nv">result</span><span class="k">}</span><span class="s2">"</span>

      <span class="c"># Catch stderr of this command</span>
      <span class="nb">echo</span> <span class="s2">"+-- push from local dev to origin dev"</span>
      <span class="nv">result</span><span class="o">=</span><span class="sb">`</span>git push origin dev 2&gt;&amp;1<span class="sb">`</span>
      sleep_with_msg 0.5

      is_succeeded_git_command <span class="s2">"</span><span class="k">${</span><span class="nv">result</span><span class="k">}</span><span class="s2">"</span>
      <span class="nv">is_succeeded</span><span class="o">=</span><span class="nv">$?</span>
      <span class="k">if</span> <span class="o">[[</span> is_succeeded <span class="nt">-eq</span> <span class="k">${</span><span class="nv">FALSE</span><span class="k">}</span> <span class="o">]]</span><span class="p">;</span> <span class="k">then
          </span><span class="nb">echo</span> <span class="s2">"</span><span class="k">${</span><span class="nv">result</span><span class="k">}</span><span class="s2">"</span>
          <span class="nb">echo</span> <span class="s2">"+-- failed"</span>
          <span class="k">return </span>9001
      <span class="k">fi
      </span><span class="nb">echo</span> <span class="s2">"echo result :: </span><span class="k">${</span><span class="nv">result</span><span class="k">}</span><span class="s2">"</span>

      <span class="nb">echo</span> <span class="s2">"+-- done"</span>
  <span class="o">}</span>

  pull_and_push
</pre></table></code></div></div></ul><h2 id="주요-shell-문법">주요 shell 문법</h2><ul><li>함수<ul><li>선언<ul><li><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre>  <span class="k">function </span>함수이름<span class="o">()</span> <span class="o">{</span>
      <span class="k">return </span>리턴값
  <span class="o">}</span>
</pre></table></code></div></div></ul><li>실행<ul><li><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre>  <span class="c"># 함수이름만 적으면 실행된다.</span>
  <span class="c"># 인자는 공백으로 구분한다.</span>
  함수이름 인자1 인자2
</pre></table></code></div></div></ul><li>받은 인자의 처리<ul><li><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre><td class="rouge-code"><pre>  <span class="c"># 받은 인자는 순서대로 $순서 변수에 담긴다.</span>
  <span class="c"># ex. 함수이름 인자1 인자2이면 인자1은 $1, 인자2는 $2에 담긴다.</span>
  <span class="c"># shell에서 그냥 변수 선언 및 할당하면 무조건 global이다.</span>
  <span class="c"># 함수 안에서만 동작하는 변수를 쓰고 싶다면 local 명령어를 써야한다.</span>
  <span class="k">function </span>함수이름<span class="o">()</span> <span class="o">{</span>
      <span class="nb">local </span>인자1<span class="o">=</span><span class="nv">$1</span> <span class="c">#인자1에 9가 담김</span>
      <span class="nb">local </span>인자2<span class="o">=</span><span class="nv">$2</span> <span class="c">#인자2에 a가 담김</span>
      <span class="k">return </span>리턴값
  <span class="o">}</span>

  함수이름 9 <span class="s2">"a"</span>
</pre></table></code></div></div></ul><li>함수 리턴값 받기<ul><li><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre>  <span class="c"># $?라는 특수 변수는 마지막으로 실행된 명령어, 함수 등의 종료값을 받는다.</span>
  <span class="k">function </span>함수이름<span class="o">()</span> <span class="o">{</span>
      <span class="k">return </span>9
  <span class="o">}</span>

  함수이름
  <span class="nb">echo</span> <span class="s2">"</span><span class="nv">$?</span><span class="s2">"</span> <span class="c"># 이 스크립트를 실행하면 9가 출력된다.</span>
</pre></table></code></div></div></ul></ul></ul><h2 id="is_succeeded_git_command-함수-설명">is_succeeded_git_command 함수 설명</h2><ul><li>깃 명령어 실행결과 문자열을 받아 성공 여부를 체크하는 함수이다.<li>bash shell에서는 boolean type으로 true, false을 사용하나<br /> 나의 경우 boolean type 테스트가 매우 헷갈려서 그냥 숫자로 할당하여 처리하였다.<br /> <a href="https://stackoverflow.com/questions/2953646/how-can-i-declare-and-use-boolean-variables-in-a-shell-script" target="\_blank">shell boolean type</a><li>bash shell에서는 equal test도 여러개이다(<a href="https://stackoverflow.com/questions/20449543/shell-equality-operators-eq" target="\_blank">shell equality operators</a>).<ul><li>[[ ${a} = ${b} ]]는 POSIX shell 기반으로 문자열 변수 동일여부 체크 시 사용한다.<br /> 이 방법은 정규 표현식 처리가 불가능하다.<li>[[ ${a} == ${b} ]]는 bash shell 기반으로 문자열 변수 동일여부 체크 시 사용한다.<br /> 이 방법은 정규 표현식 처리가 가능하다.<li>[[ ${a} -eq ${b} ]]는 bash shell 기반으로 정수형 변수 동일여부 체크 시 사용한다.</ul><li>git 명령어 실패 시 에러메세지 앞에는 error라는 문구가 항상 포함됨으로<br /> [[ ${message} == *error* ]] 테스트를 통해 git 명령어 에러 여부를 판단한다<br /> (표준에러와 표준출력이 섞여서 있어서 좀 모호하긴 함 ^^;;)</ul><h2 id="pull_and_push-함수-설명">pull_and_push 함수 설명</h2><ul><li>주요 로직이 포함된 함수이다.<li>git pull –rebase upstream dev 2&gt;&amp;1<ul><li><a href="https://blogger.pe.kr/369">2&gt;&amp;1 이해하기</a>를 먼저 읽으면 좋다.<li>2는 파일디스트럭터 중 하나로 표준에러를 의미한다.<li>1은 파일디스트럭터 중 하나로 표준출력을 의미한다.<li>2&gt;&amp;1을 쓰면 표준에러를 표준출력으로 보내겠다는 뜻이다.<li>2&gt;&amp;1이 없으면 에러가 표준출력으로 변환되지 않기 때문에 ‘|’ 등의 문법을 쓸 수 없다.</ul><li>명령어 표준출력을 변수에 할당<ul><li>변수이름=`명령`<li>따라서 result=`git pull –rebase upstream dev 2&gt;&amp;1`는 <br /> git pull –rebase 명령 실행 결과(표준출력, 표준에러 포함)가 result 변수에 저장된다.</ul></ul><h2 id="참고">참고</h2><ul><li><a href="https://stackoverflow.com/questions/229551/how-to-check-if-a-string-contains-a-substring-in-bash">substring 포함 여부 확인</a><li><a href="https://stackoverflow.com/questions/637827/redirect-stderr-and-stdout-in-bash">stderr를 stdout으로 변경하는 명령</a><li><a href="https://stackoverflow.com/questions/4651437/how-do-i-set-a-variable-to-the-output-of-a-command-in-bash">shell script 명령 결과 할당</a><li><a href="https://brocess.tistory.com/84">shell script sleep 명령</a><li><a href="https://stackoverflow.com/questions/8742783/returning-value-from-called-function-in-a-shell-script/8743103">funciton 리턴 변수</a><li><a href="https://stackoverflow.com/questions/20449543/shell-equality-operators-eq">shell equal</a><li><a href="https://wiki.kldp.org/HOWTO/html/Adv-Bash-Scr-HOWTO/string-manipulation.html">kldp</a><li><a href="https://zetawiki.com/wiki/%EB%A6%AC%EB%88%85%EC%8A%A4_$%3F">리눅스 $?</a><li><a href="https://blog.gaerae.com/2015/10/what-is-the-preferred-bash-shebang.html">shebang bash</a><li><a href="https://velog.io/@jakeseo_me/%EC%9C%A0%EB%8B%89%EC%8A%A4%EC%9D%98-stdin-stdout-stderr-%EA%B7%B8%EB%A6%AC%EA%B3%A0-pipes%EC%97%90-%EB%8C%80%ED%95%B4-%EC%95%8C%EC%95%84%EB%B3%B4%EC%9E%90">unix shell의 stdout, stderr</a></ul></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/shell/'>Shell</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/shell-script/" class="post-tag no-text-decoration" >shell script</a> <a href="/tags/git/" class="post-tag no-text-decoration" >git</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=git push 시 자동으로 pull and push하는 shell script 작성 - 의사줌치&url=https://a3magic3pocket.github.io/posts/pull-and-push-automation/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=git push 시 자동으로 pull and push하는 shell script 작성 - 의사줌치&u=https://a3magic3pocket.github.io/posts/pull-and-push-automation/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=git push 시 자동으로 pull and push하는 shell script 작성 - 의사줌치&url=https://a3magic3pocket.github.io/posts/pull-and-push-automation/" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i class="fa-fw fas fa-link small" onclick="copyLink()" data-toggle="tooltip" data-placement="top" title="Copy link"></i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"><div id="access-lastmod" class="post"> <span>Recent Update</span><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/kafka-large-scale-event-processing-architecture-and-performance-comparison/">Kafka를 활용한 대용량 이벤트 처리 구조 설계와 성능 비교</a><li><a href="/posts/experimenting-with-blue-green-deployments/">블루 - 그린 배포 실험</a><li><a href="/posts/spring-kafka-latest-message-pub-sub-config/">Spring Kafka에서 최신 메시지만 소비하는 Pub/Sub 방식 설정</a><li><a href="/posts/solving-concurrency-problems-with-performance-in-mind/">동시성 문제 해결 방안 성능 실험</a><li><a href="/posts/exploring-authentication-options/">인증방식 고민</a></ul></div><div id="access-tags"> <span>Trending Tags</span><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/kafka/">kafka</a> <a class="post-tag" href="/tags/kotlin/">kotlin</a> <a class="post-tag" href="/tags/elasticsearch/">elasticsearch</a> <a class="post-tag" href="/tags/elk/">elk</a> <a class="post-tag" href="/tags/spring/">spring</a> <a class="post-tag" href="/tags/summary/">summary</a> <a class="post-tag" href="/tags/git/">git</a> <a class="post-tag" href="/tags/kafka-streams/">kafka-streams</a> <a class="post-tag" href="/tags/nest/">nest</a> <a class="post-tag" href="/tags/react/">react</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"> <span class="pl-3 pt-2 mb-2">Contents</span><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="post-extend-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/local-git-config/"><div class="card-body"> <span class="timeago small" > Dec 6, 2020 <i class="unloaded">2020-12-06T12:58:00+09:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>local git repository에서 git user 세팅</h3><div class="text-muted small"><p> 개요 가끔씩 clone 한 git repo에 user setting이 되지 않아서 원격 repo의 commit 목록에 global user가 노출되는 경우가 있다. 화사 프로젝트 repo와 같이 여러 사람이 같이 쓰는 private repo에서 이런 일이 발생하면 관리자의 따가운 시선을 받을 수 있다. local git repo에서 git...</p></div></div></a></div><div class="card"> <a href="/posts/set-git-config-for-mutiple-ids/"><div class="card-body"> <span class="timeago small" > Dec 6, 2020 <i class="unloaded">2020-12-06T12:58:00+09:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>한 pc에 여러 github id ssh 키 등록하기</h3><div class="text-muted small"><p> 개요 때때로 여러 github id를 개인 pc에서 사용할 때가 있다. 이때 매번 로그인하기 귀찮으므로 각 github id 마다 ssh 키를 등록해보자 환경 os: Ubuntu 18.04.5 LTS ssh 키 생성 설명 id 마다 ssh 키를 생성해준다. 예시에서는 편의상 id1, id2로 지...</p></div></div></a></div><div class="card"> <a href="/posts/cicd-using-git-action-and-dockerhub/"><div class="card-body"> <span class="timeago small" > Feb 5, 2023 <i class="unloaded">2023-02-05T12:49:00+09:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>git action과 dockerhub을 이용한 CI/CD 파이프라인 구축</h3><div class="text-muted small"><p> CI/CD란 상세한 정의 Red Hat 문서에 상세하게 잘 적혀있다. CI/CD(CI CD, 지속적 통합/지속적 배포): 개념, 툴, 구축, 차이 (redhat.com) CI/CD 파이프라인: 개념, 방법, 장점, 구현 과정 (redhat.com) ...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/html-parser-error/" class="btn btn-outline-primary" prompt="Older"><p>html-proofer HTML parsing error 해결</p></a> <a href="/posts/jekyll-theme-chirpy-with-gem/" class="btn btn-outline-primary" prompt="Newer"><p>gem 기반으로 jekyll 블로그 만들기(chirpy 테마, windows)</p></a></div></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center"><div class="footer-left"><p class="mb-0"> © 2025 <a href="https://github.com/a3magic3pocket">의사줌치</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><h4 class="text-muted mb-4">Trending Tags</h4><a class="post-tag" href="/tags/kafka/">kafka</a> <a class="post-tag" href="/tags/kotlin/">kotlin</a> <a class="post-tag" href="/tags/elasticsearch/">elasticsearch</a> <a class="post-tag" href="/tags/elk/">elk</a> <a class="post-tag" href="/tags/spring/">spring</a> <a class="post-tag" href="/tags/summary/">summary</a> <a class="post-tag" href="/tags/git/">git</a> <a class="post-tag" href="/tags/kafka-streams/">kafka streams</a> <a class="post-tag" href="/tags/nest/">nest</a> <a class="post-tag" href="/tags/react/">react</a></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.7.3/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="https://a3magic3pocket.github.io{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script>
